<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Nest.js 入门 | 朝花夕拾</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/logo.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c">
    <meta name="description" content="朝花夕拾技术空间">
    <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1, minimum-scale=1">
    <meta name="theme-color" content="#000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/0.styles.e3cb5c2f.css" as="style"><link rel="preload" href="/assets/js/app.82fea960.js" as="script"><link rel="preload" href="/assets/js/38.9c1eeb6e.js" as="script"><link rel="preload" href="/assets/js/3.dea4e8e5.js" as="script"><link rel="preload" href="/assets/js/123.515b4431.js" as="script"><link rel="prefetch" href="/assets/js/10.86925cab.js"><link rel="prefetch" href="/assets/js/100.ac4a324d.js"><link rel="prefetch" href="/assets/js/101.bd19e9f3.js"><link rel="prefetch" href="/assets/js/102.e58268d4.js"><link rel="prefetch" href="/assets/js/103.649f4611.js"><link rel="prefetch" href="/assets/js/104.33961969.js"><link rel="prefetch" href="/assets/js/105.c3f2e6ec.js"><link rel="prefetch" href="/assets/js/106.1f35734e.js"><link rel="prefetch" href="/assets/js/107.1f08b735.js"><link rel="prefetch" href="/assets/js/108.74043e21.js"><link rel="prefetch" href="/assets/js/109.cc459b62.js"><link rel="prefetch" href="/assets/js/11.933f43b8.js"><link rel="prefetch" href="/assets/js/110.f9573fd9.js"><link rel="prefetch" href="/assets/js/111.1d5cb496.js"><link rel="prefetch" href="/assets/js/112.5f2ea1c8.js"><link rel="prefetch" href="/assets/js/113.05f8dad9.js"><link rel="prefetch" href="/assets/js/114.1524487a.js"><link rel="prefetch" href="/assets/js/115.293075e1.js"><link rel="prefetch" href="/assets/js/116.fda3878c.js"><link rel="prefetch" href="/assets/js/117.2af897ac.js"><link rel="prefetch" href="/assets/js/118.0afea1ef.js"><link rel="prefetch" href="/assets/js/119.8e478a31.js"><link rel="prefetch" href="/assets/js/12.394aa2be.js"><link rel="prefetch" href="/assets/js/120.9b76548c.js"><link rel="prefetch" href="/assets/js/121.b2fd1f71.js"><link rel="prefetch" href="/assets/js/122.7f2f17ed.js"><link rel="prefetch" href="/assets/js/124.b8449631.js"><link rel="prefetch" href="/assets/js/125.996c6237.js"><link rel="prefetch" href="/assets/js/126.9e973ced.js"><link rel="prefetch" href="/assets/js/127.a2cc6fa4.js"><link rel="prefetch" href="/assets/js/128.6ceabd42.js"><link rel="prefetch" href="/assets/js/129.5bcc636a.js"><link rel="prefetch" href="/assets/js/13.73416f05.js"><link rel="prefetch" href="/assets/js/130.272d408b.js"><link rel="prefetch" href="/assets/js/131.b9a7fb12.js"><link rel="prefetch" href="/assets/js/132.5ae7acf3.js"><link rel="prefetch" href="/assets/js/133.9b339ef5.js"><link rel="prefetch" href="/assets/js/134.fb34d394.js"><link rel="prefetch" href="/assets/js/135.1b4a8c1b.js"><link rel="prefetch" href="/assets/js/136.54c66bdf.js"><link rel="prefetch" href="/assets/js/137.8e217c58.js"><link rel="prefetch" href="/assets/js/138.6f820efb.js"><link rel="prefetch" href="/assets/js/139.369d8b3b.js"><link rel="prefetch" href="/assets/js/14.a1b86171.js"><link rel="prefetch" href="/assets/js/140.0b682180.js"><link rel="prefetch" href="/assets/js/141.0843a38c.js"><link rel="prefetch" href="/assets/js/142.80a80644.js"><link rel="prefetch" href="/assets/js/143.813d7d0d.js"><link rel="prefetch" href="/assets/js/144.79982f80.js"><link rel="prefetch" href="/assets/js/145.44c39f6d.js"><link rel="prefetch" href="/assets/js/146.88327ae7.js"><link rel="prefetch" href="/assets/js/147.89811d85.js"><link rel="prefetch" href="/assets/js/148.97179fb4.js"><link rel="prefetch" href="/assets/js/149.46904a6a.js"><link rel="prefetch" href="/assets/js/15.906b3d7e.js"><link rel="prefetch" href="/assets/js/150.369f81b2.js"><link rel="prefetch" href="/assets/js/151.4c07351f.js"><link rel="prefetch" href="/assets/js/152.c11f3969.js"><link rel="prefetch" href="/assets/js/153.261b8f54.js"><link rel="prefetch" href="/assets/js/154.811bdfac.js"><link rel="prefetch" href="/assets/js/155.b80a0a71.js"><link rel="prefetch" href="/assets/js/156.5ff280b9.js"><link rel="prefetch" href="/assets/js/157.b34df6c9.js"><link rel="prefetch" href="/assets/js/158.57dd3e32.js"><link rel="prefetch" href="/assets/js/159.dda99a75.js"><link rel="prefetch" href="/assets/js/16.78d3a971.js"><link rel="prefetch" href="/assets/js/160.9ba64bbd.js"><link rel="prefetch" href="/assets/js/161.4adfad2e.js"><link rel="prefetch" href="/assets/js/162.b5f59b9d.js"><link rel="prefetch" href="/assets/js/163.0100948a.js"><link rel="prefetch" href="/assets/js/164.156f533b.js"><link rel="prefetch" href="/assets/js/165.80348f20.js"><link rel="prefetch" href="/assets/js/166.722ad5bf.js"><link rel="prefetch" href="/assets/js/167.db1273ab.js"><link rel="prefetch" href="/assets/js/168.eb143651.js"><link rel="prefetch" href="/assets/js/169.310da92d.js"><link rel="prefetch" href="/assets/js/17.b389674a.js"><link rel="prefetch" href="/assets/js/170.89d86fd3.js"><link rel="prefetch" href="/assets/js/171.9ecf5023.js"><link rel="prefetch" href="/assets/js/172.1f2d4af4.js"><link rel="prefetch" href="/assets/js/173.8aeb9d2a.js"><link rel="prefetch" href="/assets/js/174.09943a63.js"><link rel="prefetch" href="/assets/js/175.2f623f4c.js"><link rel="prefetch" href="/assets/js/176.fb75d166.js"><link rel="prefetch" href="/assets/js/177.9bbc7606.js"><link rel="prefetch" href="/assets/js/178.3b8b15e5.js"><link rel="prefetch" href="/assets/js/179.6c2b2e26.js"><link rel="prefetch" href="/assets/js/18.012507c6.js"><link rel="prefetch" href="/assets/js/180.8b5e0529.js"><link rel="prefetch" href="/assets/js/181.9364fed2.js"><link rel="prefetch" href="/assets/js/182.abe7c748.js"><link rel="prefetch" href="/assets/js/183.24cbfc60.js"><link rel="prefetch" href="/assets/js/184.c4dd9899.js"><link rel="prefetch" href="/assets/js/185.ef828c13.js"><link rel="prefetch" href="/assets/js/186.2cd4ae9b.js"><link rel="prefetch" href="/assets/js/187.4989b84d.js"><link rel="prefetch" href="/assets/js/188.30e7c5b9.js"><link rel="prefetch" href="/assets/js/189.257aa931.js"><link rel="prefetch" href="/assets/js/19.c25881ee.js"><link rel="prefetch" href="/assets/js/190.b2706c5c.js"><link rel="prefetch" href="/assets/js/191.9e2fa356.js"><link rel="prefetch" href="/assets/js/192.a30016e1.js"><link rel="prefetch" href="/assets/js/193.992b55a5.js"><link rel="prefetch" href="/assets/js/194.02db45b6.js"><link rel="prefetch" href="/assets/js/195.ec60ca02.js"><link rel="prefetch" href="/assets/js/196.36c80fd6.js"><link rel="prefetch" href="/assets/js/197.2c6cdc0e.js"><link rel="prefetch" href="/assets/js/198.dcdacef4.js"><link rel="prefetch" href="/assets/js/20.d2c84fe9.js"><link rel="prefetch" href="/assets/js/21.456fe10f.js"><link rel="prefetch" href="/assets/js/22.8b2266ed.js"><link rel="prefetch" href="/assets/js/23.bd8fc307.js"><link rel="prefetch" href="/assets/js/24.abe92a4a.js"><link rel="prefetch" href="/assets/js/25.b2fca8cc.js"><link rel="prefetch" href="/assets/js/26.c283e9bb.js"><link rel="prefetch" href="/assets/js/27.66b19172.js"><link rel="prefetch" href="/assets/js/28.2d6daffa.js"><link rel="prefetch" href="/assets/js/29.40262d12.js"><link rel="prefetch" href="/assets/js/30.05ea4f94.js"><link rel="prefetch" href="/assets/js/31.e7953efb.js"><link rel="prefetch" href="/assets/js/32.bb6dc178.js"><link rel="prefetch" href="/assets/js/33.168db12b.js"><link rel="prefetch" href="/assets/js/34.9324222e.js"><link rel="prefetch" href="/assets/js/35.01698b9c.js"><link rel="prefetch" href="/assets/js/36.aa6a4b93.js"><link rel="prefetch" href="/assets/js/37.c2fe6fe3.js"><link rel="prefetch" href="/assets/js/39.021538ca.js"><link rel="prefetch" href="/assets/js/4.aa6490bf.js"><link rel="prefetch" href="/assets/js/40.bd2bc5e7.js"><link rel="prefetch" href="/assets/js/41.1d141937.js"><link rel="prefetch" href="/assets/js/42.3eac3c75.js"><link rel="prefetch" href="/assets/js/43.dcf95fb5.js"><link rel="prefetch" href="/assets/js/44.ba342d24.js"><link rel="prefetch" href="/assets/js/45.ec0c95e6.js"><link rel="prefetch" href="/assets/js/46.6c228836.js"><link rel="prefetch" href="/assets/js/47.e0b1efd4.js"><link rel="prefetch" href="/assets/js/48.17106a86.js"><link rel="prefetch" href="/assets/js/49.d24a36fe.js"><link rel="prefetch" href="/assets/js/5.5021d13c.js"><link rel="prefetch" href="/assets/js/50.1e27a5c8.js"><link rel="prefetch" href="/assets/js/51.3f252642.js"><link rel="prefetch" href="/assets/js/52.a63b41c9.js"><link rel="prefetch" href="/assets/js/53.4eaaca26.js"><link rel="prefetch" href="/assets/js/54.3cb6f085.js"><link rel="prefetch" href="/assets/js/55.976010d2.js"><link rel="prefetch" href="/assets/js/56.ff8caea3.js"><link rel="prefetch" href="/assets/js/57.a8ecfda1.js"><link rel="prefetch" href="/assets/js/58.9e4e3a36.js"><link rel="prefetch" href="/assets/js/59.a59efd57.js"><link rel="prefetch" href="/assets/js/6.79643474.js"><link rel="prefetch" href="/assets/js/60.27c4fcd4.js"><link rel="prefetch" href="/assets/js/61.b6435aef.js"><link rel="prefetch" href="/assets/js/62.05126af2.js"><link rel="prefetch" href="/assets/js/63.5685ec25.js"><link rel="prefetch" href="/assets/js/64.e255ead0.js"><link rel="prefetch" href="/assets/js/65.443233d1.js"><link rel="prefetch" href="/assets/js/66.58e1b039.js"><link rel="prefetch" href="/assets/js/67.d1f44273.js"><link rel="prefetch" href="/assets/js/68.6dbc079c.js"><link rel="prefetch" href="/assets/js/69.59ae4aea.js"><link rel="prefetch" href="/assets/js/7.87a04a7a.js"><link rel="prefetch" href="/assets/js/70.15324845.js"><link rel="prefetch" href="/assets/js/71.6f74dcde.js"><link rel="prefetch" href="/assets/js/72.76338e49.js"><link rel="prefetch" href="/assets/js/73.b831a50e.js"><link rel="prefetch" href="/assets/js/74.456df025.js"><link rel="prefetch" href="/assets/js/75.7c90efaf.js"><link rel="prefetch" href="/assets/js/76.4033a860.js"><link rel="prefetch" href="/assets/js/77.efa1010a.js"><link rel="prefetch" href="/assets/js/78.4d00931f.js"><link rel="prefetch" href="/assets/js/79.d75cb47f.js"><link rel="prefetch" href="/assets/js/8.62ce477c.js"><link rel="prefetch" href="/assets/js/80.eaa60fee.js"><link rel="prefetch" href="/assets/js/81.c464c6ec.js"><link rel="prefetch" href="/assets/js/82.01534af2.js"><link rel="prefetch" href="/assets/js/83.90ddb538.js"><link rel="prefetch" href="/assets/js/84.31a7306b.js"><link rel="prefetch" href="/assets/js/85.38a7ef79.js"><link rel="prefetch" href="/assets/js/86.b72ad5f3.js"><link rel="prefetch" href="/assets/js/87.0c2ab5b4.js"><link rel="prefetch" href="/assets/js/88.6d75ad37.js"><link rel="prefetch" href="/assets/js/89.a01a195a.js"><link rel="prefetch" href="/assets/js/9.adf3f42d.js"><link rel="prefetch" href="/assets/js/90.e57522c2.js"><link rel="prefetch" href="/assets/js/91.40608853.js"><link rel="prefetch" href="/assets/js/92.8cd151d2.js"><link rel="prefetch" href="/assets/js/93.003cae43.js"><link rel="prefetch" href="/assets/js/94.e11a7ef9.js"><link rel="prefetch" href="/assets/js/95.d3a0e866.js"><link rel="prefetch" href="/assets/js/96.f84930d3.js"><link rel="prefetch" href="/assets/js/97.b3b382e1.js"><link rel="prefetch" href="/assets/js/98.7cc754ce.js"><link rel="prefetch" href="/assets/js/99.bbaabb48.js"><link rel="prefetch" href="/assets/js/vendors~flowchart.3977d582.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e3cb5c2f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">朝花夕拾</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Introduction.html" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/FrontEnd/" class="nav-link">
  前端基础
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">前端框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">前端框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://vue3.tanyp.xyz" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vue3
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="/React/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/Vue/" class="nav-link">
  Vue2
</a></li><li class="dropdown-item"><!----> <a href="/AngularJS/" class="nav-link">
  AngularJS
</a></li></ul></div></div><div class="nav-item"><a href="/JsFrame/" class="nav-link">
  技术方案
</a></div><div class="nav-item"><a href="/FrontEndTool/" class="nav-link">
  前端工程化
</a></div><div class="nav-item"><a href="/NodeJS/" class="nav-link router-link-active">
  NodeJS
</a></div><div class="nav-item"><a href="/TS/" class="nav-link">
  TypeScript
</a></div><div class="nav-item"><a href="/Java/" class="nav-link">
  Java
</a></div><div class="nav-item"><a href="/notes/" class="nav-link">
  Notes
</a></div><div class="nav-item"><a href="/Reading/" class="nav-link">
  Reading
</a></div><div class="nav-item"><a href="/DSA/" class="nav-link">
  数据结构与算法
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Introduction.html" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/FrontEnd/" class="nav-link">
  前端基础
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">前端框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">前端框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://vue3.tanyp.xyz" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vue3
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="/React/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/Vue/" class="nav-link">
  Vue2
</a></li><li class="dropdown-item"><!----> <a href="/AngularJS/" class="nav-link">
  AngularJS
</a></li></ul></div></div><div class="nav-item"><a href="/JsFrame/" class="nav-link">
  技术方案
</a></div><div class="nav-item"><a href="/FrontEndTool/" class="nav-link">
  前端工程化
</a></div><div class="nav-item"><a href="/NodeJS/" class="nav-link router-link-active">
  NodeJS
</a></div><div class="nav-item"><a href="/TS/" class="nav-link">
  TypeScript
</a></div><div class="nav-item"><a href="/Java/" class="nav-link">
  Java
</a></div><div class="nav-item"><a href="/notes/" class="nav-link">
  Notes
</a></div><div class="nav-item"><a href="/Reading/" class="nav-link">
  Reading
</a></div><div class="nav-item"><a href="/DSA/" class="nav-link">
  数据结构与算法
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/NodeJS/" aria-current="page" class="sidebar-link">Introduction</a></li><li><a href="/NodeJS/Node基础.html" class="sidebar-link">Node基础</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Node核心模块</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/NodeJS/core-module/fs.html" class="sidebar-link">fs</a></li><li><a href="/NodeJS/core-module/path.html" class="sidebar-link">path</a></li><li><a href="/NodeJS/core-module/Buffer.html" class="sidebar-link">Buffer</a></li></ul></section></li><li><a href="/NodeJS/Node的工具集.html" class="sidebar-link">Node 的工具集</a></li><li><a href="/NodeJS/Koa.html" class="sidebar-link">koa</a></li><li><a href="/NodeJS/dev-server.html" class="sidebar-link">dev-server</a></li><li><a href="/NodeJS/Nest.js入门.html" class="active sidebar-link">Nest.js 入门</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/NodeJS/Nest.js入门.html#前言" class="sidebar-link">前言</a></li><li class="sidebar-sub-header"><a href="/NodeJS/Nest.js入门.html#hello-world" class="sidebar-link">Hello world</a></li><li class="sidebar-sub-header"><a href="/NodeJS/Nest.js入门.html#控制器-controller" class="sidebar-link">控制器（Controller）</a></li><li class="sidebar-sub-header"><a href="/NodeJS/Nest.js入门.html#提供者-provider" class="sidebar-link">提供者（Provider）</a></li><li class="sidebar-sub-header"><a href="/NodeJS/Nest.js入门.html#模块-module" class="sidebar-link">模块（Module）</a></li><li class="sidebar-sub-header"><a href="/NodeJS/Nest.js入门.html#中间件-middleware" class="sidebar-link">中间件（Middleware ）</a></li><li class="sidebar-sub-header"><a href="/NodeJS/Nest.js入门.html#过滤器-exception-filter" class="sidebar-link">过滤器（Exception filter）</a></li><li class="sidebar-sub-header"><a href="/NodeJS/Nest.js入门.html#管道-pipe" class="sidebar-link">管道（Pipe）</a></li><li class="sidebar-sub-header"><a href="/NodeJS/Nest.js入门.html#守卫-guard" class="sidebar-link">守卫（Guard）</a></li><li class="sidebar-sub-header"><a href="/NodeJS/Nest.js入门.html#拦截器-interceptor" class="sidebar-link">拦截器（Interceptor）</a></li><li class="sidebar-sub-header"><a href="/NodeJS/Nest.js入门.html#执行顺序" class="sidebar-link">执行顺序</a></li><li class="sidebar-sub-header"><a href="/NodeJS/Nest.js入门.html#sql-typeorm" class="sidebar-link">SQL（TypeORM）</a></li><li class="sidebar-sub-header"><a href="/NodeJS/Nest.js入门.html#nest-cli" class="sidebar-link">Nest Cli</a></li><li class="sidebar-sub-header"><a href="/NodeJS/Nest.js入门.html#总结" class="sidebar-link">总结</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="nest-js-入门"><a href="#nest-js-入门" class="header-anchor">#</a> Nest.js 入门</h1> <p></p><div class="table-of-contents"><ul><li><a href="#前言">前言</a></li><li><a href="#hello-world">Hello world</a></li><li><a href="#控制器-controller">控制器（Controller）</a><ul><li><a href="#请求方法">请求方法</a></li><li><a href="#http-请求对象">http 请求对象</a></li><li><a href="#路由">路由</a></li><li><a href="#路由参数">路由参数</a></li><li><a href="#状态码">状态码</a></li><li><a href="#响应头">响应头</a></li><li><a href="#异步">异步</a></li><li><a href="#dto">DTO</a></li></ul></li><li><a href="#提供者-provider">提供者（Provider）</a><ul><li><a href="#服务-service">服务（Service）</a></li><li><a href="#依赖注入">依赖注入</a></li><li><a href="#注册提供者">注册提供者</a></li></ul></li><li><a href="#模块-module">模块（Module）</a></li><li><a href="#中间件-middleware">中间件（Middleware ）</a></li><li><a href="#过滤器-exception-filter">过滤器（Exception filter）</a></li><li><a href="#管道-pipe">管道（Pipe）</a></li><li><a href="#守卫-guard">守卫（Guard）</a></li><li><a href="#拦截器-interceptor">拦截器（Interceptor）</a></li><li><a href="#执行顺序">执行顺序</a></li><li><a href="#sql-typeorm">SQL（TypeORM）</a><ul><li><a href="#新建实体类">新建实体类</a></li><li><a href="#创建-database-提供者">创建 database 提供者</a></li></ul></li><li><a href="#nest-cli">Nest Cli</a></li><li><a href="#总结">总结</a></li></ul></div><p></p> <h2 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h2> <p>Nest 是一套基于 Node.js 的强大的 Web 框架，可帮助你轻松构建出高效的、可扩展的应用程序。它是通过结合 OOP （面向对象编程）和 FP （函数式编程）的最佳理念，采用现代化 JavaScript(ES6+)，使用 TypeScript 构建的。</p> <p>Nest 不仅仅只是一套框架，因为它是基于著名的流行库 Express 和 Socket.io 构建的（你也可以根据自己的需求选择任何其他库），所以无需等待社区成长，可以直接使用，更无需担心第三方库的缺失。</p> <h2 id="hello-world"><a href="#hello-world" class="header-anchor">#</a> Hello world</h2> <p><strong>（1）创建项目:</strong></p> <div class="language-sh extra-class"><pre class="language-sh"><code>$ <span class="token function">npm</span> i <span class="token parameter variable">-g</span> @nestjs/cli
$ nest new project-name
</code></pre></div><p><strong>（2）启动:</strong></p> <div class="language-sh extra-class"><pre class="language-sh"><code>$ <span class="token builtin class-name">cd</span> project-name
$ <span class="token function">npm</span> start
</code></pre></div><h2 id="控制器-controller"><a href="#控制器-controller" class="header-anchor">#</a> 控制器（Controller）</h2> <p>控制器负责处理传入的请求并将响应返回给客户端。</p> <p><img src="https://docs.nestjs.com/assets/Controllers_1.png" alt="image"></p> <p>控制器的目的是接收应用程序的特定请求。路由策略控制着哪些控制器接收哪些请求。通常，每个控制器具有多个路由，并且不同的路由可以执行不同的动作。</p> <p>为了创建一个基本的控制器，我们使用类和装饰器。装饰器将类与所需的元数据相关联，并使 Nest 能够创建路由映射（将请求绑定到相应的控制器）。</p> <div class="language-sh extra-class"><pre class="language-sh"><code> nest g co <span class="token function">users</span> //使用 CLI 提供的 generate （别名：g） 命令生成一个基本的 <span class="token function">users</span> Controller （别名： co）：
</code></pre></div><h3 id="请求方法"><a href="#请求方法" class="header-anchor">#</a> 请求方法</h3> <p>其中 @Put()，@Delete()，@Patch()，@Options()，@Head() 和 @All()。每个代表其各自的 HTTP 请求方法。</p> <h3 id="http-请求对象"><a href="#http-请求对象" class="header-anchor">#</a> http 请求对象</h3> <table><thead><tr><th>装饰器</th> <th>说明</th></tr></thead> <tbody><tr><td>@Request()</td> <td>req</td></tr> <tr><td>@Response()</td> <td>res</td></tr> <tr><td>@Next()</td> <td>next</td></tr> <tr><td>@Session()</td> <td>res.session</td></tr> <tr><td>@Param(key?: string)</td> <td>res.params</td></tr> <tr><td>@Body(key?: string)</td> <td>res.body</td></tr> <tr><td>@Query(key?: string)</td> <td>res.query</td></tr> <tr><td>@Headers(name?: string)</td> <td>res.headers</td></tr></tbody></table> <h3 id="路由"><a href="#路由" class="header-anchor">#</a> 路由</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Controller<span class="token punctuation">,</span> Get<span class="token punctuation">,</span> Post <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>

@<span class="token function">Controller</span><span class="token punctuation">(</span><span class="token string">'cats'</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CatsController</span> <span class="token punctuation">{</span>
  @<span class="token function">Post</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> string <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'This action adds a new cat'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  @<span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> string <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'This action returns all cats'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="路由参数"><a href="#路由参数" class="header-anchor">#</a> 路由参数</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Controller<span class="token punctuation">,</span> Get<span class="token punctuation">,</span> Post <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>
<span class="token comment">//路由名称</span>
@<span class="token function">Controller</span><span class="token punctuation">(</span><span class="token string">'cats'</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CatsController</span> <span class="token punctuation">{</span>
  @<span class="token function">Post</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> string <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'This action adds a new cat'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  @<span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> string <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'This action returns all cats'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 路由通配符</span>
  @<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">'ab*cd'</span><span class="token punctuation">)</span>
  <span class="token function">findAll2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'This route uses a wildcard'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 路由参数</span>
  @<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">':id'</span><span class="token punctuation">)</span>
  <span class="token function">findOne</span><span class="token punctuation">(</span>@<span class="token function">Param</span><span class="token punctuation">(</span><span class="token punctuation">)</span> params<span class="token punctuation">)</span><span class="token operator">:</span> string <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>params<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">This action returns a #</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>params<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> cat</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>需要注意的是路由匹配也有顺序</p> <h3 id="状态码"><a href="#状态码" class="header-anchor">#</a> 状态码</h3> <p>更改请求的状态码</p> <div class="language-js extra-class"><pre class="language-js"><code>@<span class="token function">Post</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
@<span class="token function">HttpCode</span><span class="token punctuation">(</span><span class="token number">204</span><span class="token punctuation">)</span>
<span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token string">'This action adds a new cat'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="响应头"><a href="#响应头" class="header-anchor">#</a> 响应头</h3> <p>要指定自定义响应标头，您可以使用 @Header() 装饰器或特定于库的响应对象（并 res.header() 直接调用）。</p> <div class="language-js extra-class"><pre class="language-js"><code>@<span class="token function">Post</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
@<span class="token function">Header</span><span class="token punctuation">(</span><span class="token string">'Cache-Control'</span><span class="token punctuation">,</span> <span class="token string">'none'</span><span class="token punctuation">)</span>
<span class="token comment">// Access-Control-Allow-Origin :*</span>
<span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token string">'This action adds a new cat'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="异步"><a href="#异步" class="header-anchor">#</a> 异步</h3> <p>我们可以使用 async / await
或者使用 RxJS (Nest 将自动订阅下面的源并获取最后一个发射值）</p> <div class="language-js extra-class"><pre class="language-js"><code>@<span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Observable<span class="token operator">&lt;</span>any<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">of</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="dto"><a href="#dto" class="header-anchor">#</a> DTO</h3> <p>DTO 是一个定义网络发送的对象，相当于请求方法的接口，但是 nest 最后会转成 js, 在转换的过程中 interface 会被删除，所以这里推荐使用 class , 类是 javascript ES6 的一部分。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 创建Dto类</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CreateCatDto</span> <span class="token punctuation">{</span>
  readonly name<span class="token operator">:</span> string<span class="token punctuation">;</span>
  readonly age<span class="token operator">:</span> number<span class="token punctuation">;</span>
  readonly breed<span class="token operator">:</span> string<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//使用Dto</span>
@<span class="token function">Post</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token parameter">@<span class="token function">Body</span><span class="token punctuation">(</span><span class="token punctuation">)</span> createCatDto<span class="token operator">:</span> CreateCatDto</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token string">'This action adds a new cat'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="提供者-provider"><a href="#提供者-provider" class="header-anchor">#</a> 提供者（Provider）</h2> <p>Provider 是 Nest 的基本概念。许多基本的 Nest 类可以被视为提供者 - 服务，存储库，工厂，helper 等。提供者的主要思想是它可以注入依赖关系。</p> <p>控制器一般只处理 HTTP 请求，并将更复杂的任务委派给提供者。
提供者就是一个简单的 JavaScript 类， 然后使用 @Injectable 装饰器修饰。</p> <h3 id="服务-service"><a href="#服务-service" class="header-anchor">#</a> 服务（Service）</h3> <p>service 负责业务逻辑，核心是如何将业务逻辑抽象成接口及其粒度。service 层应该尽量提供功能相对单一的基础方法，更多的场景和变化可以在 controller 层实现。这样设计有利于 service 层的复用和稳定。主要实现业务逻辑。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Injectable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Cat <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./interfaces/cat.interface'</span><span class="token punctuation">;</span>

@<span class="token function">Injectable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CatsService</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> readonly cats<span class="token operator">:</span> Cat<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token function">create</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">cat</span><span class="token operator">:</span> Cat</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>cats<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>cat<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Cat<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cats<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//要使用CLI创建服务，只需执行$ nest g service cats命令即可。</span>
</code></pre></div><p>此时的 Controller</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Controller<span class="token punctuation">,</span> Get<span class="token punctuation">,</span> Post<span class="token punctuation">,</span> Body <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CreateCatDto <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./dto/create-cat.dto'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CatsService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./cats.service'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Cat <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./interfaces/cat.interface'</span><span class="token punctuation">;</span>

@<span class="token function">Controller</span><span class="token punctuation">(</span><span class="token string">'cats'</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CatsController</span> <span class="token punctuation">{</span>
  <span class="token comment">//请注意private readonly语法的使用。这个简写允许我们 catsService 在同一位置立即声明和初始化成员。</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">private</span> readonly catsService<span class="token operator">:</span> CatsService</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  @<span class="token function">Post</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">async</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token parameter">@<span class="token function">Body</span><span class="token punctuation">(</span><span class="token punctuation">)</span> createCatDto<span class="token operator">:</span> CreateCatDto</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>catsService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>createCatDto<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  @<span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">async</span> <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Promise<span class="token operator">&lt;</span>Cat<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>catsService<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="依赖注入"><a href="#依赖注入" class="header-anchor">#</a> 依赖注入</h3> <p>依赖注入（Dependency Injection，简称 DI） 是实现 控制反转（Inversion of Control，缩写为 IoC） 的一种常见方式。</p> <h4 id="什么是控制反转呢"><a href="#什么是控制反转呢" class="header-anchor">#</a> 什么是控制反转呢</h4> <p>控制反转，是面向对象编程中的一种设计原则，可以用来减低计算机代码之间的耦合度。通过控制反转，对象在被创建的时候，由一个调控系统内所有对象的外界实体，将其所依赖的对象的引用传递给它。也可以说，依赖被注入到对象。
我们看一个例子</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 比如一个类A中，需要用到另一个类B的方法，那么我们就要在A中实例化B，然后调用B的方法。代码如下：</span>
<span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">{</span>
 <span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 b<span class="token punctuation">.</span><span class="token function">active</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/*假设，我们还有C类，D类等。他们也都要用到B的方法，同样地他们也需要实例化B，然后调用B的方法。如果B的实例化是一个十分消耗系统资源的过程，比如数据库连接等。那么这样每次一个类中需要调用B的方法，就要实例化B一次，这将是一个非常消耗系统资源的过程。*/</span>
</code></pre></div><h4 id="nest-中的依赖注入"><a href="#nest-中的依赖注入" class="header-anchor">#</a> Nest 中的依赖注入</h4> <p>nest 就是建立在依赖注入这种设计模式之上的，所以它在框架内部封装了一个 IoC 容器来管理所有的依赖关系。
在 MVC 设计模式中， Controller 只负责对请求的分发，并不处理实际的业务逻辑。Service 主要处理实际业务逻辑 (CRUD)。</p> <h3 id="注册提供者"><a href="#注册提供者" class="header-anchor">#</a> 注册提供者</h3> <p>现在我们已经定义了一个 provider（CatsService），并且我们有了该 service（CatsController）的使用者，我们需要使用 Nest 注册该服务，以便它可以执行注入。我们通过编辑模块文件（app.module.ts）并将服务添加到装饰器的 providers 数组来完成此操作 @Module()。</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span>module<span class="token punctuation">.</span>ts <span class="token constant">JS</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> Module <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CatsController <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./cats/cats.controller'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CatsService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./cats/cats.service'</span><span class="token punctuation">;</span>

@<span class="token function">Module</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">controllers</span><span class="token operator">:</span> <span class="token punctuation">[</span>CatsController<span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">providers</span><span class="token operator">:</span> <span class="token punctuation">[</span>CatsService<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AppModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><h2 id="模块-module"><a href="#模块-module" class="header-anchor">#</a> 模块（Module）</h2> <p>模块化是指解决一个复杂问题时自顶向下逐层把系统划分成若干模块的过程，有多种属性，分别反映其内部特性。</p> <p><img src="https://docs.nestjs.com/assets/Modules_1.png" alt="image"></p> <p>在 CatsController 与 CatsService 属于同一功能。由于它们密切相关，因此将它们移动到模块中。功能模块只是组织与特定功能相关的代码，保持代码建立清晰的边界。这有助于我们管理复杂性并使用 SOLID 原则进行开发，尤其是随着应用程序或团队规模的增长。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Module <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CatsController <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./cats.controller'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CatsService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./cats.service'</span><span class="token punctuation">;</span>

@<span class="token function">Module</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">controllers</span><span class="token operator">:</span> <span class="token punctuation">[</span>CatsController<span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">providers</span><span class="token operator">:</span> <span class="token punctuation">[</span>CatsService<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CatsModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">//要使用CLI创建模块，只需执行$ nest g module cats命令即可。</span>
</code></pre></div><p>最后是将此模块导入根模块</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span>module<span class="token punctuation">.</span>ts <span class="token constant">JS</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> Module <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CatsModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./cats/cats.module'</span><span class="token punctuation">;</span>

@<span class="token function">Module</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">imports</span><span class="token operator">:</span> <span class="token punctuation">[</span>CatsModule<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AppModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><h2 id="中间件-middleware"><a href="#中间件-middleware" class="header-anchor">#</a> 中间件（Middleware ）</h2> <p>中间件是在路由处理程序之前调用的函数。中间件功能可以访问请求和响应对象，以及应用程序请求 - 响应周期中的下一个中间件功能。下一个中间件函数通常由一个名为 next 的变量表示。</p> <ul><li>执行任何代码。</li> <li>对请求和响应对象进行更改。</li> <li>请求 - 响应周期结束。</li> <li>调用堆栈中的下一个中间件函数。</li> <li>如果当前中间件函数没有结束请求 - 响应周期，它必须调用 next() 将控制权传递给下一个中间件函数。否则，请求将被挂起。</li></ul> <h2 id="过滤器-exception-filter"><a href="#过滤器-exception-filter" class="header-anchor">#</a> 过滤器（Exception filter）</h2> <p>捕获错误信息，返回响应给客户端。可以控制器中的类、方法、全局注册使用，可以做自定义响应异常格式。</p> <h2 id="管道-pipe"><a href="#管道-pipe" class="header-anchor">#</a> 管道（Pipe）</h2> <p>数据流处理，在中间件后路由处理前做数据处理，可以控制器中的类、方法、方法参数、全局注册使用，只能是一个纯函数。可以做数据验证，数据转换（将输入数据转换为所需的输出）等数据处理。</p> <h2 id="守卫-guard"><a href="#守卫-guard" class="header-anchor">#</a> 守卫（Guard）</h2> <p>决定请求是否可以到达对应的路由处理器，能够知道当前路由的执行上下文，可以控制器中的类、方法、全局注册使用，可以做角色守卫。</p> <h2 id="拦截器-interceptor"><a href="#拦截器-interceptor" class="header-anchor">#</a> 拦截器（Interceptor）</h2> <p>进入控制器之前和之后处理相关逻辑，能够知道当前路由的执行上下文，可以控制器中的类、方法、全局注册使用，可以做日志、事务处理、异常处理、响应数据格式等。</p> <h2 id="执行顺序"><a href="#执行顺序" class="header-anchor">#</a> 执行顺序</h2> <p>客户端请求 ---&gt; 中间件 ---&gt; 守卫 ---&gt; 拦截器之前 ---&gt; 管道 ---&gt; 控制器处理并响应 ---&gt; 拦截器之后 ---&gt; 过滤器</p> <h2 id="sql-typeorm"><a href="#sql-typeorm" class="header-anchor">#</a> SQL（TypeORM）</h2> <p>什么是 ORM</p> <p>它的作用是在关系型数据库和对象之间作一个映射，这样，我们在具体的操作数据库的时候，就不需要再去和复杂的 SQL 语句打交道，只要像平时操作对象一样操作它就可以了 。
比如:</p> <ul><li>save({name:'张三',age:1}); // 保存指定对象</li> <li>findAll();// 查询所有</li> <li>remove({id:123}); // 根据 id 删除指定对象</li> <li>findOne({id:123}) // 根据 id 查出指定对象</li> <li>...</li></ul> <h3 id="新建实体类"><a href="#新建实体类" class="header-anchor">#</a> 新建实体类</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Entity<span class="token punctuation">,</span> Column<span class="token punctuation">,</span> PrimaryGeneratedColumn <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span><span class="token punctuation">;</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Users</span> <span class="token punctuation">{</span>
    @<span class="token function">PrimaryGeneratedColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 组件</span>
    <span class="token literal-property property">id</span><span class="token operator">:</span> number<span class="token punctuation">;</span>
    @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">length</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span><span class="token literal-property property">unique</span><span class="token operator">:</span><span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">//是否唯一，并限制长度为10</span>
    <span class="token literal-property property">date</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
    @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token string">'int'</span><span class="token punctuation">)</span> <span class="token comment">// int类型</span>
    <span class="token literal-property property">value</span><span class="token operator">:</span> number<span class="token punctuation">;</span>
    @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token literal-property property">isActive</span><span class="token operator">:</span> boolean<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="创建-database-提供者"><a href="#创建-database-提供者" class="header-anchor">#</a> 创建 database 提供者</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createConnection <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> databaseProviders <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">provide</span><span class="token operator">:</span> <span class="token string">'DATABASE_CONNECTION'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">useFactory</span><span class="token operator">:</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">await</span> <span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'mysql'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">host</span><span class="token operator">:</span> <span class="token string">'localhost'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token number">3306</span><span class="token punctuation">,</span>
      <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">'root'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token string">'123456'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">database</span><span class="token operator">:</span> <span class="token string">'test'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">entities</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          __dirname <span class="token operator">+</span> <span class="token string">'/../**/*.entity{.ts,.js}'</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token literal-property property">synchronize</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>创建 Module 模块</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Module <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> databaseProviders <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./database.providers'</span><span class="token punctuation">;</span>

@<span class="token function">Module</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">providers</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">...</span>databaseProviders<span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">exports</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">...</span>databaseProviders<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">DatabaseModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p>连接实体类，并且创建对应业务的 Provide</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Connection<span class="token punctuation">,</span> Repository <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Users <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./users.entity'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> usersProviders <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">provide</span><span class="token operator">:</span> <span class="token string">'USERS_REPOSITORY'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">useFactory</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">connection</span><span class="token operator">:</span> Connection</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> connection<span class="token punctuation">.</span><span class="token function">getRepository</span><span class="token punctuation">(</span>Users<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">inject</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'DATABASE_CONNECTION'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>具体使用</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Injectable<span class="token punctuation">,</span> Inject <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> TravelDay <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./user.interface'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Users <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./users.entity'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Repository <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span><span class="token punctuation">;</span>

@<span class="token function">Injectable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UsersService</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span>
        @<span class="token function">Inject</span><span class="token punctuation">(</span><span class="token string">'USERS_REPOSITORY'</span><span class="token punctuation">)</span>
        <span class="token keyword">private</span> readonly usersRepository<span class="token operator">:</span> Repository<span class="token operator">&lt;</span>Users<span class="token operator">&gt;</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
     <span class="token function">create</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">params</span><span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>usersRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="nest-cli"><a href="#nest-cli" class="header-anchor">#</a> Nest Cli</h2> <p>简单用法</p> <div class="language- extra-class"><pre class="language-text"><code>$ nest generate service users
或者
$ nest g s users
</code></pre></div><table><thead><tr><th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>class （简写：cl)</td> <td>类</td></tr> <tr><td>controller （简写：co)</td> <td>控制器</td></tr> <tr><td>decorator （简写：d)</td> <td>装饰器</td></tr> <tr><td>exception （简写：e)</td> <td>异常捕获</td></tr> <tr><td>filter （简写：f)</td> <td>过滤器</td></tr> <tr><td>gateway （简写：ga)</td> <td>网关</td></tr> <tr><td>guard （简写：gu)</td> <td>守卫</td></tr> <tr><td>interceptor （简写：i)</td> <td>拦截器</td></tr> <tr><td>middleware （简写：mi)</td> <td>中间件</td></tr> <tr><td>module （简写：mo)</td> <td>模块</td></tr> <tr><td>pipe （简写：pi)</td> <td>管道</td></tr> <tr><td>provider （简写：pr)</td> <td>供应商</td></tr> <tr><td>service （简写：s)</td> <td>服务</td></tr></tbody></table> <h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <p>NestJS 使用现代 JavaScript，使用 Typescript （保留与纯 JavaScript 的兼容性）构建，熟悉 angluar 的开发者能更快的入门，不仅是前端开发人员，哪怕是熟悉 Java Spring MVC 的后端开发者也能快速入门。</p> <p>参考链接：</p> <ul><li><a href="https://docs.nestjs.com/" target="_blank" rel="noopener noreferrer">nestJS文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="http://nodejs.cn/api/fs.html" target="_blank" rel="noopener noreferrer">nodeJS文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.imooc.com/article/51098" target="_blank" rel="noopener noreferrer">SOLID原则<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <blockquote><p>此文来自内部同事的分享</p></blockquote></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/NodeJS/dev-server.html" class="prev">
        dev-server
      </a></span> <!----></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.82fea960.js" defer></script><script src="/assets/js/38.9c1eeb6e.js" defer></script><script src="/assets/js/3.dea4e8e5.js" defer></script><script src="/assets/js/123.515b4431.js" defer></script>
  </body>
</html>
