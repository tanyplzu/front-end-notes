# 网络协议进阶

_刘超《趣谈网络协议》 笔记_

[[toc]]

## 第1讲 | 为什么要学习网络协议

### TCP 在进行三次握手的时候，IP 层和 MAC 层对应都有什么操作呢

当然是 TCP 发送每一个消息，都会带着 IP 层和 MAC 层了。因为，TCP 每发送一个消息，IP 层和 MAC 层的所有机制都要运行一遍。而你只看到 TCP 三次握手了，其实，IP 层和 MAC 层为此也忙活好久了。

只要是在网络上跑的包，都是完整的。可以有下层没上层，绝对不可能有上层没下层。对 TCP 协议来说，三次握手也好，重试也好，只要想发出去包，就要有 IP 层和 MAC 层，不然是发不出去的。

### 一些问题

问题：A 知道自己的下一个中转站是 B，那从 A 发出来的包，应该把 B 的 IP 地址放在哪里呢？B 知道自己的下一个中转站是 C，从 B 发出来的包，应该把 C 的 IP 地址放在哪里呢？如果放在 IP 协议中的目标地址，那包到了中转站，怎么知道最终的目的地址是 D 呢？

问题：问题你一定经常听说二层设备、三层设备。二层设备处理的通常是 MAC 层的东西。那我发送一个 HTTP 的包，是在第七层工作的，那是不是不需要经过二层设备？或者即便经过了，二层设备也不处理呢？或者换一种问法，二层设备处理的包里，有没有 HTTP 层的内容呢？

问题：从你的电脑，通过 SSH 登录到公有云主机里面，都需要经历哪些过程？或者说你打开一个电商网站，都需要经历哪些过程？说得越详细越好。

### 问题：网络为什么要分层

因为，是个复杂的程序都要分层。

### 那你知道 ifconfig 和 ip addr 的区别吗

ip addr

### IP 地址

本来 32 位的 IP 地址就不够，还被分成了 5 类。

## DHCP与PXE

动态主机配置协议（DHCP）

预启动执行环境（PXE）

## 第5讲 | 从物理层到MAC层
两台电脑已经构成了一个最小的局域网，也即 LAN


## 第7讲 | ICMP与ping

ping 是基于 ICMP 协议工作的。ICMP 全称 Internet Control Message Protocol，就是互联网控制报文协议。

ping 就是查询报文，是一种主动请求，并且获得主动应答的 ICMP 协议。所以，ping 发的包也是符合 ICMP 协议格式的，只不过它在后面增加了自己的格式。

## 第10讲 | UDP协议

TCP 和 UDP 有哪些区别？一般面试的时候我问这两个协议的区别，大部分人会回答，TCP 是面向连接的，UDP 是面向无连接的。

所谓的建立连接，是为了在客户端和服务端维护连接，而建立一定的数据结构来维护双方交互的状态，用这样的数据结构来保证所谓的面向连接的特性。

## 第11讲 | TCP协议（上）

## 第14讲 | HTTP协议
