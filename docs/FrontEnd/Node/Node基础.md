## Node

### 怎么看 nodejs 可支持高并发

1. nodejs 的单线程架构模型

nodejs 其实并不是真正的单线程架构，因为 nodejs 还有I/O线程存在（网络I/O、磁盘I/O），这些I/O线程是由更底层的 libuv 处理，这部分线程对于开发者来说是透明的。 JavaScript 代码永远运行在V8上，是单线程的。
所以从开发者的角度上来看 nodejs 是单线程的。

优势：

单线程就一个线程在玩，省去了线程间切换的开销
还有线程同步的问题，线程冲突的问题的也不需要担心

劣势：

劣势也很明显，现在起步都是 4 核，单线程没法充分利用 cpu 的资源
单线程，一旦崩溃，应用就挂掉了，大家调试脚本也知道一旦执行过程报错了，本次调试就直接结束了
因为只能利用一个 cpu ，一旦 cpu 被某个计算一直占用， cpu 得不到释放，后续的请求就会一直被挂起，直接无响应了

> 当然这些劣势都已经有成熟的解决方案了，使用 PM2 管理进程，或者上 K8S 也可以

2.核心：事件循环机制

那你个单线程怎么支持高并发呢？
核心就要在于 js 引擎的事件循环机制（我觉得这个开场还挺不错）
浏览器和 nodejs 的事件循环是稍有区别的，先给面试官简单说下事件循环的核心，执行栈、宏队列和微队列，具体的介绍可以看我以前写的一篇总结 js 事件循环
然后重点说 nodejs 事件循环的差异点，因不想把两个问题混在一起，所以独立成一个问题，具体讲解大家稍微往下翻看下一个问题的解答。


