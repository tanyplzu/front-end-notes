(window.webpackJsonp=window.webpackJsonp||[]).push([[100],{442:function(t,a,s){"use strict";s.r(a);var e=s(6),r=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"babel-api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#babel-api"}},[t._v("#")]),t._v(" babel api")]),t._v(" "),a("p",[t._v("babel 7 把这些功能的实现放到了不同的包里面：")]),t._v(" "),a("h2",{attrs:{id:"babel-parser"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#babel-parser"}},[t._v("#")]),t._v(" @babel/parser")]),t._v(" "),a("p",[t._v("解析源码成 AST，对应 parse 阶段")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@babel/parser'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("parse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'code'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// parse in strict mode and allow module declarations")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("sourceType")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'module'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("plugins")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// enable jsx and flow syntax")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'jsx'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'flow'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("ul",[a("li",[t._v("@babel/traverse 遍历 AST 并调用 visitor 函数，对应 transform 阶段")]),t._v(" "),a("li",[t._v("@babel/generate 打印 AST，生成目标代码和 sorucemap，对应 generate 阶段")])]),t._v(" "),a("p",[t._v("其中，遍历过程中需要创建 AST，会用到：")]),t._v(" "),a("ul",[a("li",[t._v("@babel/types 创建、判断 AST")]),t._v(" "),a("li",[t._v("@babel/template 根据模块批量创建 AST")])]),t._v(" "),a("p",[t._v("上面是每一个阶段的功能， babel 整体功能的入口是在：")]),t._v(" "),a("ul",[a("li",[t._v("@babel/core 解析配置、应用 plugin、preset，整体整体编译流程")])]),t._v(" "),a("p",[t._v("插件和插件之间有一些公共函数，这些都是在：")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("@babel/helpers 用于转换 es next 代码需要的通过模板创建的 AST，比如 _typeof、_defineProperties 等")])]),t._v(" "),a("li",[a("p",[t._v("@babel/helper-xxx 其他的插件之间共享的用于操作 AST 的公共函数当然，除了编译期转换的时候会有公共函数以外，运行时也有，这部分是放在：")])]),t._v(" "),a("li",[a("p",[t._v("@babel/runtime 主要是包含 corejs、helpers、regenerator 这 3 部分：")])]),t._v(" "),a("li",[a("p",[t._v("helper： helper 函数的运行时版本（不是通过 AST 注入了，而是运行时引入代码）")])]),t._v(" "),a("li",[a("p",[t._v("corejs： es next 的 api 的实现，corejs 2 只支持静态方法，corejs 3 还支持实例方法")])]),t._v(" "),a("li",[a("p",[t._v("regenerator：async await 的实现，由 facebook 维护（babel 做语法转换是自己实现的 helper，但是做 polyfill 都不是自己实现的，而是借助了第三方的 corejs、regenerator）")])])])])}),[],!1,null,null,null);a.default=r.exports}}]);